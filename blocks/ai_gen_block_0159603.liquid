{% doc %}
  @prompt
    portrait small video with text to the side, Can you have this section centered within the width of the screen or browser size?, Can I upload a video instead of using a link?, Can you lock the video size to auto match with the width? For example, the chosen width should have the whole video in it, not a portion., Can you resize the video down to make sure it fits appropriately? currently the height doesn't match appropriately with the chosen width, so instead of seeing the whole video, you see a very long sliver of it., The size of the video space is great, but the video itself wasn't resized so that you only see a small portion (imagine zoomed in through a small lense). Can you please shrink the video size to match with the space given with the video width and max height?
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-portrait-video-wrapper-{{ ai_gen_id }} {
    width: 100%;
    display: flex;
    justify-content: center;
    padding: {{ block.settings.section_padding }}px 20px;
    background-color: {{ block.settings.background_color }};
  }

  .ai-portrait-video-{{ ai_gen_id }} {
    display: flex;
    flex-direction: row;
    gap: {{ block.settings.gap }}px;
    align-items: center;
    padding: {{ block.settings.padding }}px;
    max-width: {{ block.settings.max_width }}px;
    width: 100%;
  }

  .ai-portrait-video__video-wrapper-{{ ai_gen_id }} {
    flex: 0 0 auto;
    width: {{ block.settings.video_width }}px;
    max-width: 100%;
  }

  .ai-portrait-video__video-container-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    height: {{ block.settings.video_max_height }}px;
    border-radius: {{ block.settings.border_radius }}px;
    overflow: hidden;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-portrait-video__video-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: contain;
  }

  .ai-portrait-video__placeholder-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f4f4f4;
  }

  .ai-portrait-video__placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.3;
  }

  .ai-portrait-video__empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 8px 16px;
    font-size: 14px;
    color: #666;
    text-align: center;
    pointer-events: none;
  }

  .ai-portrait-video__content-{{ ai_gen_id }} {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: {{ block.settings.text_gap }}px;
  }

  .ai-portrait-video__heading-{{ ai_gen_id }} {
    margin: 0;
    font-size: {{ block.settings.heading_size }}px;
    color: {{ block.settings.heading_color }};
    line-height: 1.2;
  }

  .ai-portrait-video__text-{{ ai_gen_id }} {
    margin: 0;
    font-size: {{ block.settings.text_size }}px;
    color: {{ block.settings.text_color }};
    line-height: 1.5;
  }

  .ai-portrait-video__button-{{ ai_gen_id }} {
    display: inline-block;
    padding: 12px 24px;
    background-color: {{ block.settings.button_color }};
    color: {{ block.settings.button_text_color }};
    text-decoration: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-size: {{ block.settings.button_text_size }}px;
    transition: background-color 0.3s ease;
    align-self: flex-start;
  }

  .ai-portrait-video__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_color }};
  }

  @media screen and (max-width: 749px) {
    .ai-portrait-video-{{ ai_gen_id }} {
      flex-direction: column;
      gap: {{ block.settings.gap | times: 0.75 }}px;
    }

    .ai-portrait-video__video-wrapper-{{ ai_gen_id }} {
      width: 100%;
      max-width: {{ block.settings.video_width | times: 0.8 }}px;
    }

    .ai-portrait-video__video-container-{{ ai_gen_id }} {
      height: {{ block.settings.video_max_height | times: 0.8 }}px;
    }

    .ai-portrait-video__heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.heading_size | times: 0.8 }}px;
    }

    .ai-portrait-video__text-{{ ai_gen_id }} {
      font-size: {{ block.settings.text_size | times: 0.9 }}px;
    }
  }
{% endstyle %}

<div class="ai-portrait-video-wrapper-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-portrait-video-{{ ai_gen_id }}">
    <div class="ai-portrait-video__video-wrapper-{{ ai_gen_id }}">
      <div class="ai-portrait-video__video-container-{{ ai_gen_id }}">
        {% if block.settings.video != blank %}
          {{
            block.settings.video
            | video_tag:
              autoplay: block.settings.autoplay,
              loop: block.settings.loop,
              muted: block.settings.muted,
              controls: block.settings.controls,
              class: 'ai-portrait-video__video-' | append: ai_gen_id
          }}
        {% else %}
          <div class="ai-portrait-video__placeholder-{{ ai_gen_id }}">
            {{ 'image' | placeholder_svg_tag }}
            <div class="ai-portrait-video__empty-state-{{ ai_gen_id }}">
              Next, add a video
            </div>
          </div>
        {% endif %}
      </div>
    </div>

    <div class="ai-portrait-video__content-{{ ai_gen_id }}">
      {% if block.settings.heading != blank %}
        <h2 class="ai-portrait-video__heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
      {% endif %}

      {% if block.settings.text != blank %}
        <div class="ai-portrait-video__text-{{ ai_gen_id }}">{{ block.settings.text }}</div>
      {% endif %}

      {% if block.settings.button_text != blank and block.settings.button_link != blank %}
        <a href="{{ block.settings.button_link }}" class="ai-portrait-video__button-{{ ai_gen_id }}">
          {{ block.settings.button_text }}
        </a>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Portrait video with text",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Video"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video"
    },
    {
      "type": "range",
      "id": "video_width",
      "min": 200,
      "max": 600,
      "step": 20,
      "unit": "px",
      "label": "Video width",
      "default": 300
    },
    {
      "type": "range",
      "id": "video_max_height",
      "min": 300,
      "max": 800,
      "step": 50,
      "unit": "px",
      "label": "Video max height",
      "default": 500
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Loop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "muted",
      "label": "Muted",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "controls",
      "label": "Show controls",
      "default": false
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "Discover our story"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text",
      "default": "<p>Experience the perfect blend of style and comfort with our carefully curated collection.</p>"
    },
    {
      "type": "inline_richtext",
      "id": "button_text",
      "label": "Button text",
      "default": "Learn more"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 600,
      "max": 1400,
      "step": 100,
      "unit": "px",
      "label": "Maximum width",
      "default": 1200
    },
    {
      "type": "range",
      "id": "gap",
      "min": 20,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Gap between video and text",
      "default": 40
    },
    {
      "type": "range",
      "id": "text_gap",
      "min": 10,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Gap between text elements",
      "default": 16
    },
    {
      "type": "range",
      "id": "padding",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Inner padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Section padding",
      "default": 40
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading",
      "default": "#54504a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#54504a"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button background",
      "default": "#ad8c7d"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button hover background",
      "default": "#9a7a6b"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 36
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Text size",
      "default": 16
    },
    {
      "type": "range",
      "id": "button_text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button text size",
      "default": 16
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Button border radius",
      "default": 4
    }
  ],
  "presets": [
    {
      "name": "Portrait video with text"
    }
  ]
}
{% endschema %}
